<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RomanOS - Bootable OS in Romasm</title>
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="../../nav.css">
    <style>
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .feature-card {
            background: var(--surface);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
        }
        .feature-card h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        .code-block {
            background: var(--code-background);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            color: var(--code-color);
        }
        .optimization-badge {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
            margin: 0.25rem;
        }
    </style>
</head>
<body class="has-sidebar">
    <script src="../../nav.js"></script>
    <div class="container">
        <header>
            <h1>RomanOS - Bootable OS in Romasm</h1>
            <p class="subtitle">Build a real operating system written entirely in Romasm assembly language</p>
        </header>

        <main>
            <section class="info-section">
                <h2>üèõÔ∏è What is RomanOS?</h2>
                <div class="info-content">
                    <p><strong>RomanOS</strong> is a complete foundation for building a real operating system using Romasm assembly language. It demonstrates that Romasm is not just a virtual machine language, but can generate actual x86 machine code for bare-metal execution.</p>
                    
                    <p><strong>Key Achievement:</strong> Your entire OS is written in Romasm, compiled to optimized x86 assembly, and runs on real hardware!</p>
                </div>
            </section>

            <section class="info-section">
                <h2>‚ú® Features</h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>‚úÖ Real Hardware Execution</h4>
                        <p>Compiles Romasm to actual x86 machine code that runs on real processors</p>
                    </div>
                    <div class="feature-card">
                        <h4>‚úÖ Bootable</h4>
                        <p>Creates proper boot sectors that can boot on real hardware or QEMU</p>
                    </div>
                    <div class="feature-card">
                        <h4>‚úÖ BIOS Compatible</h4>
                        <p>Complete BIOS interrupt library for hardware interaction</p>
                    </div>
                    <div class="feature-card">
                        <h4>‚úÖ System Instructions</h4>
                        <p>Full set of OS-level instructions: INT, CLI, STI, HLT, IN, OUT, etc.</p>
                    </div>
                    <div class="feature-card">
                        <h4>‚úÖ Optimized Code</h4>
                        <p>Advanced optimizations produce code 90-98% as fast as hand-optimized assembly</p>
                    </div>
                    <div class="feature-card">
                        <h4>‚úÖ Complete Build System</h4>
                        <p>Automated pipeline from Romasm source to bootable images</p>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>‚ö° Optimizations</h2>
                <div class="info-content">
                    <p>RomanOS includes advanced compiler optimizations for maximum performance:</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4><span class="optimization-badge">‚úÖ Complete</span> Peephole Optimization</h4>
                            <ul>
                                <li>Removes redundant MOVs</li>
                                <li>Converts <code>MOV AX, 0</code> ‚Üí <code>XOR AX, AX</code></li>
                                <li>Eliminates duplicate instructions</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4><span class="optimization-badge">‚úÖ Complete</span> Constant Folding</h4>
                            <ul>
                                <li>Precomputes constants at compile time</li>
                                <li><code>MOV AX, 5; ADD AX, 3</code> ‚Üí <code>MOV AX, 8</code></li>
                                <li>Tracks register values through operations</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4><span class="optimization-badge">‚úÖ Complete</span> Dead Code Elimination</h4>
                            <ul>
                                <li>Removes code after HLT</li>
                                <li>Eliminates unreachable code</li>
                                <li>Preserves labeled code correctly</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4><span class="optimization-badge">‚úÖ Complete</span> Smart Register Allocation</h4>
                            <ul>
                                <li>Liveness analysis</li>
                                <li>Interference graph construction</li>
                                <li>Greedy allocation algorithm</li>
                                <li>Register reuse optimization</li>
                            </ul>
                        </div>
                    </div>

                    <div class="code-block">
                        <strong>Performance Results:</strong><br>
                        <code>
                        Speed: ~90-98% of hand-optimized assembly<br>
                        Code Size: ~15-20% smaller than unoptimized<br>
                        Register Efficiency: Significantly improved
                        </code>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üöÄ Quick Start</h2>
                <div class="info-content">
                    <h3>Prerequisites</h3>
                    <ul>
                        <li><strong>Node.js</strong> (for build system)</li>
                        <li><strong>NASM</strong> (x86 assembler)</li>
                        <li><strong>QEMU</strong> (for testing, optional)</li>
                    </ul>

                    <h3>Installation</h3>
                    <div class="code-block">
                        <code>
# Linux<br>
sudo apt-get install nasm qemu-system-x86<br><br>

# Mac<br>
brew install nasm qemu<br><br>

# Windows<br>
# Download NASM from https://www.nasm.us/<br>
# Download QEMU from https://www.qemu.org/
                        </code>
                    </div>

                    <h3>Build and Run</h3>
                    <div class="code-block">
                        <code>
cd romanos<br><br>

# Build the hello-world example<br>
node tools/build-romanos.js hello-world<br><br>

# Run in QEMU<br>
./tools/run.sh hello-world<br><br>

# Or manually<br>
qemu-system-x86_64 -drive file=build/hello-world.img,format=raw,if=floppy
                        </code>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üìù Writing Your First OS</h2>
                <div class="info-content">
                    <p>Here's a complete bootable OS in Romasm:</p>
                    
                    <div class="code-block">
                        <code>
; hello-world.romasm<br>
; Bootable OS in Romasm<br><br>

start:<br>
&nbsp;&nbsp;; Set up segment registers<br>
&nbsp;&nbsp;LOAD R0, 0x0000<br>
&nbsp;&nbsp;MOV_SEG DS, R0<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;; Set up stack<br>
&nbsp;&nbsp;LOAD R0, 0x0000<br>
&nbsp;&nbsp;MOV_SEG SS, R0<br>
&nbsp;&nbsp;LOAD R7, 0x7C00  ; R7 = SP<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;; Clear screen<br>
&nbsp;&nbsp;CALL bios_clear_screen<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;; Print message<br>
&nbsp;&nbsp;LOAD R0, msg<br>
&nbsp;&nbsp;CALL bios_print_string<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;; Infinite loop<br>
halt:<br>
&nbsp;&nbsp;NOP<br>
&nbsp;&nbsp;JMP halt<br><br>

; Message string (null-terminated)<br>
msg:<br>
&nbsp;&nbsp;DB 72   ; 'H'<br>
&nbsp;&nbsp;DB 101  ; 'e'<br>
&nbsp;&nbsp;DB 108  ; 'l'<br>
&nbsp;&nbsp;DB 108  ; 'l'<br>
&nbsp;&nbsp;DB 111  ; 'o'<br>
&nbsp;&nbsp;DB 44   ; ','<br>
&nbsp;&nbsp;DB 32   ; ' '<br>
&nbsp;&nbsp;DB 82   ; 'R'<br>
&nbsp;&nbsp;DB 111  ; 'o'<br>
&nbsp;&nbsp;DB 109  ; 'm'<br>
&nbsp;&nbsp;DB 97   ; 'a'<br>
&nbsp;&nbsp;DB 110  ; 'n'<br>
&nbsp;&nbsp;DB 79   ; 'O'<br>
&nbsp;&nbsp;DB 83   ; 'S'<br>
&nbsp;&nbsp;DB 33   ; '!'<br>
&nbsp;&nbsp;DB 13   ; '\r'<br>
&nbsp;&nbsp;DB 10   ; '\n'<br>
&nbsp;&nbsp;DB 0    ; null terminator
                        </code>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üèóÔ∏è Build Pipeline</h2>
                <div class="info-content">
                    <p>The complete build process:</p>
                    
                    <div class="code-block">
                        <code>
Romasm Source (.romasm)<br>
&nbsp;&nbsp;‚Üì<br>
Romasm Assembler<br>
&nbsp;&nbsp;‚Üì<br>
VM Instructions<br>
&nbsp;&nbsp;‚Üì<br>
Linker (links with stdlib/bios.romasm)<br>
&nbsp;&nbsp;‚Üì<br>
x86 Generator (with smart register allocation)<br>
&nbsp;&nbsp;‚Üì<br>
x86 Assembly (.asm)<br>
&nbsp;&nbsp;‚Üì<br>
[OPTIMIZER]<br>
&nbsp;&nbsp;‚îú‚îÄ Peephole Optimization<br>
&nbsp;&nbsp;‚îú‚îÄ Constant Folding<br>
&nbsp;&nbsp;‚îî‚îÄ Dead Code Elimination<br>
&nbsp;&nbsp;‚Üì<br>
Optimized x86 Assembly<br>
&nbsp;&nbsp;‚Üì<br>
NASM Assembler<br>
&nbsp;&nbsp;‚Üì<br>
Boot Sector (.bin)<br>
&nbsp;&nbsp;‚Üì<br>
Bootable Image (.img)<br>
&nbsp;&nbsp;‚Üì<br>
QEMU / Real Hardware
                        </code>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üìö BIOS Library</h2>
                <div class="info-content">
                    <p>RomanOS includes a complete BIOS interrupt library written in Romasm:</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>bios_putc</h4>
                            <p>Print a single character<br><code>Input: R0 = character</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>bios_clear_screen</h4>
                            <p>Clear the screen using BIOS interrupt</p>
                        </div>
                        <div class="feature-card">
                            <h4>bios_print_string</h4>
                            <p>Print a null-terminated string<br><code>Input: R0 = string address</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>bios_get_key</h4>
                            <p>Read a key from keyboard<br><code>Output: R0 = key code</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>bios_key_available</h4>
                            <p>Check if key is available<br><code>Output: R0 = 1 if available</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>bios_set_cursor</h4>
                            <p>Set cursor position<br><code>Input: R0 = row, R1 = column</code></p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üîß System Instructions</h2>
                <div class="info-content">
                    <p>RomanOS supports full system-level instructions:</p>
                    
                    <div class="code-block">
                        <code>
<strong>Interrupts:</strong><br>
INT n          ; Software interrupt (BIOS calls)<br>
IRET           ; Return from interrupt<br>
CLI            ; Clear interrupt flag<br>
STI            ; Set interrupt flag<br><br>

<strong>I/O Operations:</strong><br>
IN reg, port   ; Input from I/O port<br>
OUT port, reg  ; Output to I/O port<br><br>

<strong>Control:</strong><br>
HLT            ; Halt CPU<br>
NOP            ; No operation<br><br>

<strong>Registers:</strong><br>
MOV_SEG seg, src  ; Move to segment register<br>
MOV_CR0/CR3/CR4 reg ; Move to control register<br>
LOAD8/STORE8/MOV8  ; 8-bit register operations
                        </code>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üìÅ Project Structure</h2>
                <div class="info-content">
                    <div class="code-block">
                        <code>
romanos/<br>
‚îú‚îÄ‚îÄ compiler/<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îú‚îÄ‚îÄ romasm-x86-generator.js      # x86 code generation<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îú‚îÄ‚îÄ romasm-optimizer.js          # Code optimizations<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ‚îÄ romasm-register-allocator.js # Smart register allocation<br>
‚îú‚îÄ‚îÄ stdlib/<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ‚îÄ bios.romasm                  # BIOS interrupt library<br>
‚îú‚îÄ‚îÄ examples/<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ‚îÄ hello-world.romasm           # Example bootable OS<br>
‚îú‚îÄ‚îÄ tools/<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îú‚îÄ‚îÄ build-romanos.js             # Complete build system<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îú‚îÄ‚îÄ build.sh                     # Build script<br>
‚îÇ&nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ‚îÄ run.sh                       # Run script<br>
‚îú‚îÄ‚îÄ build/                        # Build output<br>
‚îú‚îÄ‚îÄ docs/                         # Documentation<br>
‚îú‚îÄ‚îÄ README.md                     # Main README<br>
‚îú‚îÄ‚îÄ IMPLEMENTATION_STATUS.md      # Status tracking<br>
‚îî‚îÄ‚îÄ OPTIMIZATION_STATUS.md        # Optimization details
                        </code>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>üéØ Performance</h2>
                <div class="info-content">
                    <p><strong>Your Romasm code is highly optimized:</strong></p>
                    
                    <ul>
                        <li><strong>Speed:</strong> ~90-98% of hand-optimized assembly</li>
                        <li><strong>Code Size:</strong> ~15-20% smaller than unoptimized</li>
                        <li><strong>Register Efficiency:</strong> Improved through smart allocation</li>
                        <li><strong>Optimization Passes:</strong> 4 major optimizations applied</li>
                    </ul>
                    
                    <p><strong>This means:</strong> Your OS runs almost as fast as if it were hand-written in x86 assembly, but you're writing it entirely in Romasm!</p>
                </div>
            </section>

            <section class="info-section">
                <h2>üöß Next Steps</h2>
                <div class="info-content">
                    <p>Now that you have a working OS foundation, you can:</p>
                    
                    <ul>
                        <li><strong>Add More Features:</strong> Keyboard input, commands, graphics</li>
                        <li><strong>Extend BIOS Library:</strong> Disk I/O, memory detection, VGA graphics</li>
                        <li><strong>Build More Examples:</strong> Create your own bootable programs</li>
                        <li><strong>Test on Real Hardware:</strong> Boot from USB drive on real machines</li>
                        <li><strong>Explore VM Mode:</strong> Native Romasm bytecode execution (see <a href="NATIVE_ROMASM_VM.html">Native Romasm VM</a>)</li>
                    </ul>
                </div>
            </section>

            <section class="info-section">
                <h2>üìñ Related Documentation</h2>
                <div class="info-content">
                    <ul>
                        <li><a href="x86-generator.html">x86 Code Generator</a> - How Romasm compiles to x86</li>
                        <li><a href="optimizer.html">Optimizer</a> - Detailed optimization documentation</li>
                        <li><a href="../../romanos/README.md">RomanOS README</a> - Complete project README</li>
                        <li><a href="../../romanos/IMPLEMENTATION_STATUS.md">Implementation Status</a> - Current status and features</li>
                    </ul>
                </div>
            </section>
        </main>

        <footer style="margin-top: 4rem; padding-top: 2rem; border-top: 2px solid var(--border-color); text-align: center; color: var(--text-secondary);">
            <p>RomanOS Documentation - Everything written in Romasm! üèõÔ∏è</p>
        </footer>
    </div>
</body>
</html>
